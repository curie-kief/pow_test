#include <iostream>
#include <string.h>
#include "pow_hash/cn_slow_hash.hpp"

int main(int argc, char **argv) 
{
	uint8_t hash[32];
	const uint8_t correct[32] = { 0xeb, 0x14, 0xe8, 0xa8, 0x33, 0xfa, 0xc6, 0xfe, 0x9a, 0x43, 0xb5, 0x7b, 0x33, 0x67, 0x89, 0xc4, 
		0x6f, 0xfe, 0x93, 0xf2, 0x86, 0x84, 0x52, 0x24, 0x07, 0x20, 0x60, 0x7b, 0x14, 0x38, 0x7e, 0x11}; 
	
	cn_slow_hash<2*1024*1024, 0x80000> test;

	for(size_t i=0; i < 500; i++)
		test.software_hash("", 0, hash);

	if(memcmp(hash, correct, 32) == 0)
		printf("Hash verified!\n");
	else
		printf("Hash FAILED!\n");
    return 0;
}
